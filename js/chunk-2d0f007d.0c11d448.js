(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0f007d"],{"9b42":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mt-8"},[a("v-alert",{staticStyle:{position:"absolute",top:"16px","z-index":"4"},attrs:{type:e.alertType,dismissible:"",transition:"slide-x-transition"},model:{value:e.alert,callback:function(t){e.alert=t},expression:"alert"}},[e._v(e._s(e.alertMsg))]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(){return e.$router.go(-1)}}},[a("v-icon",{attrs:{left:""}},[e._v(" mdi-chevron-left ")]),e._v(" Wróć ")],1),a("p",{staticClass:"text-h4 mt-8"},[e._v("Dodaj miejsce")]),a("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-select",{attrs:{items:e.categories,label:"Kategoria *",rules:e.rules},model:{value:e.category,callback:function(t){e.category=t},expression:"category"}}),a("v-text-field",{staticClass:"mt-5",attrs:{label:"Tytuł *",hint:"Nazwa pod jaką inni będą mogli wszyukiwać podane miejsce",rules:e.rules},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),a("v-textarea",{staticClass:"mt-5",attrs:{label:"Opis *",hint:"Krótki opis podanego miejsca",rules:e.rules},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),a("p",{staticClass:"text-subtitle-1 mb-0 mt-4"},[e._v(" Dodaj zdjęcia lub przeciągnij na pole ")]),a("div",{on:{dragover:e.dragover,dragleave:e.dragleave,drop:e.drop}},[a("v-file-input",{ref:"imginput",attrs:{accept:"image/png, image/jpeg, image/bmp, image/img","prepend-icon":"mdi-camera",chips:"",multiple:"",label:"Zdjęcia",rules:e.imageRules},on:{change:e.onAddFiles},model:{value:e.images,callback:function(t){e.images=t},expression:"images"}})],1),0!==e.imagesUrls.length?a("v-row",{staticClass:"pa-3"},e._l(e.imagesUrls,(function(t,r){return a("v-img",{key:r,staticClass:"mr-3",attrs:{"max-height":"100","max-width":"160",src:t}},[a("v-spacer"),a("v-btn",{attrs:{fab:"","x-small":"",color:"primary"},on:{click:function(t){return e.removeFile(r)}}},[a("v-icon",{attrs:{dark:""}},[e._v(" mdi-minus ")])],1)],1)})),1):e._e()],1),a("p",{staticClass:"text-subtitle-1 mb-0 mt-4"},[e._v("Podaj lokalizację miejsca")]),a("localization-select",{ref:"localizationselect"}),a("v-row",{staticClass:"justify-end mb-5"},[a("v-btn",{attrs:{color:"primary lighten-1"},on:{click:e.addPost}},[e._v("dodaj")])],1)],1)},i=[],n=a("2909"),o=a("1da1"),s=a("5530"),l=(a("96cf"),a("d3b7"),a("159b"),a("b0c0"),a("caad"),a("2532"),a("a434"),a("a4d3"),a("e01a"),a("99af"),a("498a"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("a630"),a("24e5")),c=a("5a19"),p={components:{LocalizationSelect:c["a"]},data:function(){var e=this;return{valid:!1,localization:"",title:"",category:"",categories:["Punkt widokowy","Odpoczynek","Aktywny wypoczynek"],description:"",images:[],convertedImages:[],imagesUrls:[],allowedTypes:"image/png, image/jpeg, image/bmp, image/img",imageRules:[function(e){var t=!1,a=[];return e.forEach((function(e){a.some((function(t){return t.name==e.name}))&&(t=!0),a.push(e)})),!t||"Dodano już podany plik"},function(t){return!t||!t.some((function(t){return!e.allowedTypes.includes(t.type)}))||"Podano niewłaściwy format pliku. Dopuszczalne formaty: png, jpg, jpeg, bmp, img"}],rules:[function(e){return!!e||"Pole wymagane"}],alert:!1,alertMsg:"Coś poszło nie tak! Spróbuj ponownie.",alertType:"error"}},created:function(){window.scrollTo(0,0)},methods:{removeFile:function(e){this.imagesUrls.splice(e,1),this.convertedImages.splice(e,1),this.images.splice(e,1)},addPost:function(){var e=this;if(this.$refs.form.validate(),this.valid&&this.$refs.localizationselect.markerLabel){var t=this.preprareFromData();this.convertedImages.forEach((function(e){t.append("images",e,e.name)})),l["a"].post("/api/post",t,{headers:Object(s["a"])(Object(s["a"])({},l["a"].headers),{},{"content-type":"multipart/form-data"})}).then((function(){window.scrollTo(0,0),e.alertMsg="Pomyślnie dodano miejsce",e.alert=!0,e.alertType="success",setTimeout((function(){e.alert=!1}),5e3),e.imagesUrls=[],e.$refs.form.reset(),e.$refs.localizationselect.markerLabel,e.$refs.localizationselect.markerLatLng=[0,0],e.$refs.localizationselect.markerAdded=!1,e.$refs.localizationselect.markerLabel=""})).catch((function(){window.scrollTo(0,0),e.alertMsg="Coś poszło nie tak. Spróbuj ponownie",e.alert=!0,e.alertType="error",setTimeout((function(){e.alert=!1}),5e3)}))}else this.alertMsg="Uzupełnij barkujące pola i spróbuj ponownie",this.alert=!0,this.alertType="error",setTimeout((function(){e.alert=!1}),5e3)},preprareFromData:function(){var e=new FormData,t=this.$refs.localizationselect.markerLabel;e.append("localization",this.$refs.localizationselect.markerLatLng),e.append("category",this.category),e.append("title",this.title),e.append("description",this.description),e.append("country",t.country),e.append("post_code",t.postcode),e.append("state",t.state),e.append("city",t.city||t.village||t.town);var a="".concat(t.road||""," ").concat(t.house_number||"");return e.append("street",a.trim()),e},onAddFiles:function(e){var t=this;0==e.length&&(this.convertedImages=[]),e.forEach((function(e){var a=new FileReader;a.readAsArrayBuffer(e);var r=t;a.onload=function(e){var t=new Blob([e.target.result]),a=URL.createObjectURL(t);r.imagesUrls.push(a);var i=new Image;i.src=a,i.onload=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=r.resizeMe(i),e.next=3,fetch(t).then((function(e){return e.blob()})).then((function(e){return new File([e],r.imgName()+".jpg",{type:"image/jpeg"})}));case 3:a=e.sent,r.convertedImages.push(a);case 5:case"end":return e.stop()}}),e)})))}}))},resizeMe:function(e){var t=document.createElement("canvas"),a=e.width,r=e.height,i=800,n=800;a>r?a>i&&(r=Math.round(r*=i/a),a=i):r>n&&(a=Math.round(a*=n/r),r=n),t.width=a,t.height=r;var o=t.getContext("2d");return o.drawImage(e,0,0,a,r),t.toDataURL("image/jpeg",.8)},imgName:function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=t.length,r=0;r<20;r++)e+=t.charAt(Math.floor(Math.random()*a));return e},dragover:function(e){e.preventDefault(),this.$refs.imginput.focus()},dragleave:function(e){e.preventDefault(),this.$refs.imginput.blur()},drop:function(e){var t;e.preventDefault(),this.onAddFiles(Array.from(e.dataTransfer.files)),(t=this.images).push.apply(t,Object(n["a"])(e.dataTransfer.files)),this.$refs.imginput.validate()}}},d=p,u=a("2877"),m=a("6544"),f=a.n(m),g=a("0798"),v=a("8336"),h=a("23a7"),b=a("4bd4"),w=a("132d"),y=a("adda"),k=a("0fd9"),j=a("b974"),z=a("2fa4"),x=a("8654"),T=a("a844"),_=Object(u["a"])(d,r,i,!1,null,"6e243088",null);t["default"]=_.exports;f()(_,{VAlert:g["a"],VBtn:v["a"],VFileInput:h["a"],VForm:b["a"],VIcon:w["a"],VImg:y["a"],VRow:k["a"],VSelect:j["a"],VSpacer:z["a"],VTextField:x["a"],VTextarea:T["a"]})}}]);
//# sourceMappingURL=chunk-2d0f007d.0c11d448.js.map