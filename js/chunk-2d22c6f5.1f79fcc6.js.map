{"version":3,"sources":["webpack:///./src/modules/userPanel/views/EditPlace.vue?ef93","webpack:///src/modules/userPanel/views/EditPlace.vue","webpack:///./src/modules/userPanel/views/EditPlace.vue?92a7","webpack:///./src/modules/userPanel/views/EditPlace.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","attrs","alertType","model","value","callback","$$v","alert","expression","_v","_s","alertMsg","on","$router","go","ref","valid","categories","rules","placeLocal","$set","dragover","dragleave","drop","imageRules","onAddFiles","images","attachments","length","imagesUrls","_l","img","idx","key","image","$event","removeFile","_e","localization","deletePost","addPost","staticRenderFns","components","LocalizationSelect","props","title","type","default","place","data","attachmentsToRemove","convertedImages","allowedTypes","v","hasDuplicates","checkedValues","created","window","axiosAPI","get","then","res","methods","property","push","id","splice","delete","setTimeout","catch","$refs","form","validate","localizationselect","markerLabel","forEach","formData","post","headers","preprareFromData","Object","files","reader","blob","Blob","event","target","result","blobURL","URL","createObjectURL","self","Image","resized","fetch","file","resizeMe","canvas","document","createElement","width","height","max_width","max_height","ctx","getContext","toDataURL","imgName","characters","charactersLength","i","Math","imginput","focus","blur","Array","from","dataTransfer","component","VAlert","VBtn","VFileInput","VForm","VIcon","VImg","VRow","VSelect","VSpacer","VTextField","VTextarea"],"mappings":"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","file":"js/chunk-2d22c6f5.1f79fcc6.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mt-8\"},[_c('v-alert',{staticStyle:{\"position\":\"absolute\",\"top\":\"16px\",\"z-index\":\"4\"},attrs:{\"type\":_vm.alertType,\"dismissible\":\"\",\"transition\":\"slide-x-transition\"},model:{value:(_vm.alert),callback:function ($$v) {_vm.alert=$$v},expression:\"alert\"}},[_vm._v(_vm._s(_vm.alertMsg))]),_c('v-btn',{attrs:{\"color\":\"primary\",\"text\":\"\"},on:{\"click\":function () { return _vm.$router.go(-1); }}},[_c('v-icon',{attrs:{\"left\":\"\"}},[_vm._v(\" mdi-chevron-left \")]),_vm._v(\" Wróć \")],1),_c('p',{staticClass:\"text-h4 mt-8\"},[_vm._v(\"Dodaj miejsce\")]),_c('v-form',{ref:\"form\",model:{value:(_vm.valid),callback:function ($$v) {_vm.valid=$$v},expression:\"valid\"}},[_c('v-select',{attrs:{\"items\":_vm.categories,\"label\":\"Kategoria *\",\"rules\":_vm.rules},model:{value:(_vm.placeLocal.category),callback:function ($$v) {_vm.$set(_vm.placeLocal, \"category\", $$v)},expression:\"placeLocal.category\"}}),_c('v-text-field',{staticClass:\"mt-5\",attrs:{\"label\":\"Tytuł *\",\"hint\":\"Nazwa pod jaką inni będą mogli wszyukiwać podane miejsce\",\"rules\":_vm.rules},model:{value:(_vm.placeLocal.title),callback:function ($$v) {_vm.$set(_vm.placeLocal, \"title\", $$v)},expression:\"placeLocal.title\"}}),_c('v-textarea',{staticClass:\"mt-5\",attrs:{\"label\":\"Opis *\",\"hint\":\"Krótki opis podanego miejsca\",\"rules\":_vm.rules},model:{value:(_vm.placeLocal.description),callback:function ($$v) {_vm.$set(_vm.placeLocal, \"description\", $$v)},expression:\"placeLocal.description\"}}),_c('p',{staticClass:\"text-subtitle-1 mb-0 mt-4\"},[_vm._v(\" Dodaj zdjęcia lub przeciągnij na pole \")]),_c('div',{on:{\"dragover\":_vm.dragover,\"dragleave\":_vm.dragleave,\"drop\":_vm.drop}},[_c('v-file-input',{ref:\"imginput\",attrs:{\"accept\":\"image/png, image/jpeg, image/bmp, image/img\",\"prepend-icon\":\"mdi-camera\",\"chips\":\"\",\"multiple\":\"\",\"label\":\"Zdjęcia\",\"rules\":_vm.imageRules},on:{\"change\":_vm.onAddFiles},model:{value:(_vm.images),callback:function ($$v) {_vm.images=$$v},expression:\"images\"}})],1),(_vm.attachments.length !== 0 || _vm.imagesUrls.length !== 0)?_c('v-row',{staticClass:\"pa-3\"},[_vm._l((_vm.attachments),function(img,idx){return _c('v-img',{key:(\"attachment-\" + idx),staticClass:\"mr-3\",attrs:{\"max-height\":\"100\",\"max-width\":\"160\",\"src\":img.image}},[_c('v-spacer'),_c('v-btn',{attrs:{\"fab\":\"\",\"x-small\":\"\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.removeFile(idx, 'attachments')}}},[_c('v-icon',{attrs:{\"dark\":\"\"}},[_vm._v(\" mdi-minus \")])],1)],1)}),_vm._l((_vm.imagesUrls),function(img,idx){return _c('v-img',{key:(\"image-\" + idx),staticClass:\"mr-3\",attrs:{\"max-height\":\"100\",\"max-width\":\"160\",\"src\":img}},[_c('v-spacer'),_c('v-btn',{attrs:{\"fab\":\"\",\"x-small\":\"\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.removeFile(idx, 'imagesUrls')}}},[_c('v-icon',{attrs:{\"dark\":\"\"}},[_vm._v(\" mdi-minus \")])],1)],1)})],2):_vm._e()],1),_c('p',{staticClass:\"text-subtitle-1 mb-0 mt-4\"},[_vm._v(\"Podaj lokalizację miejsca\")]),_c('localization-select',{ref:\"localizationselect\",attrs:{\"localization\":_vm.placeLocal.localization}}),_c('v-row',{staticClass:\"justify-end mb-5\"},[_c('v-btn',{attrs:{\"color\":\"error mr-2\"},on:{\"click\":_vm.deletePost}},[_vm._v(\"usuń\")]),_c('v-btn',{attrs:{\"color\":\"primary lighten-1\"},on:{\"click\":_vm.addPost}},[_vm._v(\"dodaj\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"mt-8\">\r\n    <v-alert\r\n      v-model=\"alert\"\r\n      :type=\"alertType\"\r\n      dismissible\r\n      style=\"position: absolute; top: 16px; z-index: 4\"\r\n      transition=\"slide-x-transition\"\r\n      >{{ alertMsg }}</v-alert\r\n    >\r\n    <v-btn color=\"primary\" text @click=\"() => $router.go(-1)\">\r\n      <v-icon left> mdi-chevron-left </v-icon>\r\n      Wróć\r\n    </v-btn>\r\n    <p class=\"text-h4 mt-8\">Dodaj miejsce</p>\r\n    <v-form v-model=\"valid\" ref=\"form\">\r\n      <v-select\r\n        v-model=\"placeLocal.category\"\r\n        :items=\"categories\"\r\n        label=\"Kategoria *\"\r\n        :rules=\"rules\"\r\n      ></v-select>\r\n      <v-text-field\r\n        class=\"mt-5\"\r\n        v-model=\"placeLocal.title\"\r\n        label=\"Tytuł *\"\r\n        hint=\"Nazwa pod jaką inni będą mogli wszyukiwać podane miejsce\"\r\n        :rules=\"rules\"\r\n      ></v-text-field>\r\n      <v-textarea\r\n        class=\"mt-5\"\r\n        v-model=\"placeLocal.description\"\r\n        label=\"Opis *\"\r\n        hint=\"Krótki opis podanego miejsca\"\r\n        :rules=\"rules\"\r\n      ></v-textarea>\r\n      <p class=\"text-subtitle-1 mb-0 mt-4\">\r\n        Dodaj zdjęcia lub przeciągnij na pole\r\n      </p>\r\n      <div @dragover=\"dragover\" @dragleave=\"dragleave\" @drop=\"drop\">\r\n        <v-file-input\r\n          accept=\"image/png, image/jpeg, image/bmp, image/img\"\r\n          prepend-icon=\"mdi-camera\"\r\n          ref=\"imginput\"\r\n          chips\r\n          multiple\r\n          label=\"Zdjęcia\"\r\n          :rules=\"imageRules\"\r\n          v-model=\"images\"\r\n          @change=\"onAddFiles\"\r\n        ></v-file-input>\r\n      </div>\r\n      <v-row\r\n        class=\"pa-3\"\r\n        v-if=\"attachments.length !== 0 || imagesUrls.length !== 0\"\r\n      >\r\n        <v-img\r\n          v-for=\"(img, idx) in attachments\"\r\n          :key=\"`attachment-${idx}`\"\r\n          max-height=\"100\"\r\n          max-width=\"160\"\r\n          :src=\"img.image\"\r\n          class=\"mr-3\"\r\n        >\r\n          <v-spacer></v-spacer>\r\n          <v-btn\r\n            fab\r\n            x-small\r\n            color=\"primary\"\r\n            @click=\"removeFile(idx, 'attachments')\"\r\n          >\r\n            <v-icon dark> mdi-minus </v-icon>\r\n          </v-btn></v-img\r\n        >\r\n        <v-img\r\n          v-for=\"(img, idx) in imagesUrls\"\r\n          :key=\"`image-${idx}`\"\r\n          max-height=\"100\"\r\n          max-width=\"160\"\r\n          :src=\"img\"\r\n          class=\"mr-3\"\r\n        >\r\n          <v-spacer></v-spacer>\r\n          <v-btn\r\n            fab\r\n            x-small\r\n            color=\"primary\"\r\n            @click=\"removeFile(idx, 'imagesUrls')\"\r\n          >\r\n            <v-icon dark> mdi-minus </v-icon>\r\n          </v-btn></v-img\r\n        >\r\n      </v-row>\r\n    </v-form>\r\n    <p class=\"text-subtitle-1 mb-0 mt-4\">Podaj lokalizację miejsca</p>\r\n    <localization-select\r\n      :localization=\"placeLocal.localization\"\r\n      ref=\"localizationselect\"\r\n    />\r\n    <v-row class=\"justify-end mb-5\">\r\n      <v-btn color=\"error mr-2\" @click=\"deletePost\">usuń</v-btn>\r\n      <v-btn color=\"primary lighten-1\" @click=\"addPost\">dodaj</v-btn>\r\n    </v-row>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { axiosAPI } from \"@/axiosAPI\";\r\nimport LocalizationSelect from \"../../posts/components/LocalizationSelect.vue\";\r\nexport default {\r\n  components: {\r\n    LocalizationSelect,\r\n  },\r\n  props: {\r\n    title: {\r\n      type: String,\r\n      default() {\r\n        return null;\r\n      },\r\n    },\r\n    place: {\r\n      type: Object,\r\n      default() {\r\n        return null;\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      valid: false,\r\n      attachments: [],\r\n      attachmentsToRemove: [],\r\n      placeLocal: {},\r\n      imagesUrls: [],\r\n      convertedImages: [],\r\n      categories: [\"Punkt widokowy\", \"Odpoczynek\", \"Aktywny wypoczynek\"],\r\n      images: [],\r\n      allowedTypes: \"image/png, image/jpeg, image/bmp, image/img\",\r\n      imageRules: [\r\n        (v) => {\r\n          var hasDuplicates = false;\r\n          var checkedValues = [];\r\n          v.forEach((value) => {\r\n            if (checkedValues.some((val) => val.name == value.name)) {\r\n              hasDuplicates = true;\r\n            }\r\n            checkedValues.push(value);\r\n          });\r\n          return !hasDuplicates || \"Dodano już podany plik\";\r\n        },\r\n        (v) =>\r\n          !v ||\r\n          !v.some((value) => !this.allowedTypes.includes(value.type)) ||\r\n          \"Podano niewłaściwy format pliku. Dopuszczalne formaty: png, jpg, jpeg, bmp, img\",\r\n      ],\r\n      rules: [(v) => !!v || \"Pole wymagane\"],\r\n      alert: false,\r\n      alertMsg: \"Coś poszło nie tak! Spróbuj ponownie.\",\r\n      alertType: \"error\",\r\n    };\r\n  },\r\n  async created() {\r\n    window.scrollTo(0,0);\r\n    if (this.place) {\r\n      this.placeLocal = this.place;\r\n      await axiosAPI\r\n        .get(`/api/attachments/?post=${this.place.id}`)\r\n        .then((res) => {\r\n          this.attachments = res.data;\r\n        });\r\n    } else {\r\n      await axiosAPI\r\n        .get(`/api/postretive?id=${this.title.split(\"-\").pop()}`)\r\n        .then((res) => {\r\n          this.placeLocal = res.data[0];\r\n          axiosAPI\r\n            .get(`/api/attachments/?post=${res.data[0].id}`)\r\n            .then((res) => {\r\n              this.attachments = res.data;\r\n            });\r\n        });\r\n    }\r\n  },\r\n  methods: {\r\n    removeFile(idx, property) {\r\n      if (property === \"attachments\") {\r\n        this.attachmentsToRemove.push(this.attachments[idx].id);\r\n      }\r\n      this[property].splice(idx, 1);\r\n      this.convertedImages.splice(idx, 1);\r\n      this.images.splice(idx, 1);\r\n    },\r\n    async deletePost() {\r\n      await axiosAPI\r\n        .delete(`/api/post/${this.placeLocal.id}`)\r\n        .then(() => {\r\n          this.alertMsg = \"Pomyślnie usunięto miejsce\";\r\n          this.alert = true;\r\n          this.alertType = \"success\";\r\n          setTimeout(() => {\r\n            this.alert = false;\r\n          }, 5000);\r\n          this.$router.go(-1)\r\n        })\r\n        .catch(() => {\r\n          this.alertMsg = \"Coś poszło nie tak. Spróbuj ponownie\";\r\n          this.alert = true;\r\n          this.alertType = \"error\";\r\n          setTimeout(() => {\r\n            this.alert = false;\r\n          }, 5000);\r\n        });\r\n    },\r\n    addPost() {\r\n      this.$refs.form.validate();\r\n      if (this.valid && this.$refs.localizationselect.markerLabel) {\r\n        const formData = this.preprareFromData();\r\n        this.convertedImages.forEach((image) => {\r\n          formData.append(\"images\", image, image.name);\r\n        });\r\n        axiosAPI\r\n          .post(\"/api/post\", formData, {\r\n            headers: {\r\n              ...axiosAPI.headers,\r\n              \"content-type\": \"multipart/form-data\",\r\n            },\r\n          })\r\n          .then(() => {\r\n            this.alertMsg = \"Pomyślnie dodano miejsce\";\r\n            this.alert = true;\r\n            this.alertType = \"success\";\r\n            setTimeout(() => {\r\n              this.alert = false;\r\n            }, 5000);\r\n          })\r\n          .catch(() => {\r\n            this.alertMsg = \"Coś poszło nie tak. Spróbuj ponownie\";\r\n            this.alert = true;\r\n            this.alertType = \"error\";\r\n            setTimeout(() => {\r\n              this.alert = false;\r\n            }, 5000);\r\n          });\r\n      } else {\r\n        this.alertMsg = \"Uzupełnij barkujące pola i spróbuj ponownie\";\r\n        this.alert = true;\r\n        this.alertType = \"error\";\r\n        setTimeout(() => {\r\n          this.alert = false;\r\n        }, 5000);\r\n      }\r\n    },\r\n    preprareFromData() {\r\n      const formData = new FormData();\r\n      const markerLabel = this.$refs.localizationselect.markerLabel;\r\n      formData.append(\r\n        \"localization\",\r\n        this.$refs.localizationselect.markerLatLng\r\n      );\r\n      Object.keys(this.placeLocal).forEach((key) =>\r\n        formData.append(key, this.placeLocal[key])\r\n      );\r\n      formData.append(\"attachmentsToRemove\", this.attachmentsToRemove);\r\n      formData.append(\"country\", markerLabel.country);\r\n      formData.append(\"post_code\", markerLabel.postcode);\r\n      formData.append(\"state\", markerLabel.state);\r\n      formData.append(\r\n        \"city\",\r\n        markerLabel.city || markerLabel.village || markerLabel.town\r\n      );\r\n      const street = `${markerLabel.road || \"\"} ${\r\n        markerLabel.house_number || \"\"\r\n      }`;\r\n      formData.append(\"street\", street.trim());\r\n      return formData;\r\n    },\r\n    onAddFiles(files) {\r\n      if (files.length == 0) {\r\n        this.convertedImages = [];\r\n      }\r\n      files.forEach((file) => {\r\n        const reader = new FileReader();\r\n        reader.readAsArrayBuffer(file);\r\n        const self = this;\r\n        reader.onload = function (event) {\r\n          var blob = new Blob([event.target.result]);\r\n          var blobURL = URL.createObjectURL(blob);\r\n          self.imagesUrls.push(blobURL);\r\n          var image = new Image();\r\n          image.src = blobURL;\r\n          image.onload = async function () {\r\n            var resized = self.resizeMe(image);\r\n            let file = await fetch(resized)\r\n              .then((r) => r.blob())\r\n              .then(\r\n                (blobFile) =>\r\n                  new File([blobFile], self.imgName() + \".jpg\", {\r\n                    type: \"image/jpeg\",\r\n                  })\r\n              );\r\n            self.convertedImages.push(file);\r\n          };\r\n        };\r\n      });\r\n    },\r\n    resizeMe(img) {\r\n      var canvas = document.createElement(\"canvas\");\r\n\r\n      var width = img.width;\r\n      var height = img.height;\r\n      var max_width = 800;\r\n      var max_height = 800;\r\n      if (width > height) {\r\n        if (width > max_width) {\r\n          height = Math.round((height *= max_width / width));\r\n          width = max_width;\r\n        }\r\n      } else {\r\n        if (height > max_height) {\r\n          width = Math.round((width *= max_height / height));\r\n          height = max_height;\r\n        }\r\n      }\r\n      canvas.width = width;\r\n      canvas.height = height;\r\n      var ctx = canvas.getContext(\"2d\");\r\n      ctx.drawImage(img, 0, 0, width, height);\r\n      return canvas.toDataURL(\"image/jpeg\", 0.8);\r\n    },\r\n    imgName() {\r\n      var result = \"\";\r\n      var characters =\r\n        \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n      var charactersLength = characters.length;\r\n      for (var i = 0; i < 20; i++) {\r\n        result += characters.charAt(\r\n          Math.floor(Math.random() * charactersLength)\r\n        );\r\n      }\r\n      return result;\r\n    },\r\n    dragover(event) {\r\n      event.preventDefault();\r\n      this.$refs.imginput.focus();\r\n    },\r\n    dragleave(event) {\r\n      event.preventDefault();\r\n      this.$refs.imginput.blur();\r\n    },\r\n    drop(event) {\r\n      event.preventDefault();\r\n      this.onAddFiles(Array.from(event.dataTransfer.files));\r\n      this.images.push(...event.dataTransfer.files);\r\n      this.$refs.imginput.validate();\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped></style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditPlace.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditPlace.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./EditPlace.vue?vue&type=template&id=c437dc2e&scoped=true&\"\nimport script from \"./EditPlace.vue?vue&type=script&lang=js&\"\nexport * from \"./EditPlace.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c437dc2e\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAlert } from 'vuetify/lib/components/VAlert';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VFileInput } from 'vuetify/lib/components/VFileInput';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VImg } from 'vuetify/lib/components/VImg';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\nimport { VTextarea } from 'vuetify/lib/components/VTextarea';\ninstallComponents(component, {VAlert,VBtn,VFileInput,VForm,VIcon,VImg,VRow,VSelect,VSpacer,VTextField,VTextarea})\n"],"sourceRoot":""}